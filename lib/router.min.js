"use strict";var Router=function(){const a=this;this.notfound=!0,this.routes=[],this.paramsEnabled=!1,this.routeCall=function(){},this.params=[],this.BeforeRouteMiddleware="*",this.BeforeRouteMiddlewareFunc=null,this.AfterRouteCallback=null,this.route={};let b=function(){throw new TypeError("Router.js : 404 error.")};this.setErrorCallback=function(a){b=a},this.notFoundException=function(){b.apply()},this.getCurrentURI=function(){return new RouterRequest().getURI()},this.before=function(b,c){a.BeforeRouteMiddleware=b,a.BeforeRouteMiddlewareFunc=c},this.add=function(b,c,d){let e=c.split("/"),f=!1,g=[];switch(e.forEach(function(b){":"===b.substr(0,1)&&(f=a.paramsEnabled=!0,g.push(b.substr(1,b.length)))}),c.substr(0,2)){case"#/":c=c.substr(1);break;case"/#":c=c.substr(2);}a.routes.push({name:b,route:c,callback:d,paramsEnabled:f,params:g})},this.map=function(b,c,d=[]){d.forEach(function(d){a.add(b+d.name,c+a.FormatPath(d.route,!0),d.callback)})},this.fetchRoute=function(b){let c=a.routes.find(function(a){return a.name===b||a.route===b});c===void 0&&new Exception("Target route \""+b+"\" does not exist"),c.paramsEnabled?c.paramsEnabled&&new Exception("\""+b+"\" route has parameter(s) and cannot be call dynamically"):new RouterRequest().setURI(c.route)},this.FormatPath=function(a,b=!1){return b&&"/"===a?a="":!b&&"/"===a.substr(0,1)&&(a=a.substr(1)),a};let c=function(b,c=[]){a.route=b,a.routeCall=b.callback,a.params=c,a.notfound=!1};this.handle=function(b){let d=a.getCurrentURI();b.forEach(function(b){let e=b.split("/"),f=d.split("/");if(f.length===e.length){let d=new handlingParams(b);f=f.join(""),d.RouteArray===f&&a.routes.forEach(function(e){e.route===b&&a.notfound&&c(e,d.params)})}})},this.run=function(d=null){let e=a.getCurrentURI(),f=[];a.notfound=!0,new BeforeMiddleware(a.BeforeRouteMiddleware,a.BeforeRouteMiddlewareFunc),a.routes.forEach(function(b){b.paramsEnabled?(f.push(b.route),a.handle(f)):b.route===e&&c(b)}),a.notfound?b.apply():a.routeCall.apply(null,a.params),null==d?null!=a.AfterRouteCallback&&a.AfterRouteCallback.apply():(a.AfterRouteCallback=d,a.AfterRouteCallback.apply())},window.addEventListener("hashchange",function(){a.run()})};let RouterRequest=function(){this;let a="/"+location.hash;this.getURI=function(){return"#/"===location.hash.substr(0,2)&&(a=location.hash.substr(1)),a},this.setURI=function(a){location.hash=a}},BeforeMiddleware=function(a,b){this;switch(this.route=a,this.callback=b,this.URI=new RouterRequest().getURI(),this.route.substr(0,2)){case"#/":this.route=this.route.substr(1);break;case"/#":this.route=this.route.substr(2);}null!=this.callback&&("*"===this.route?this.callback.apply():this.route===this.URI&&this.callback.apply())},handlingParams=function(a){const b=this;let c=router.getCurrentURI().split("/"),d=a.split("/"),e=[];this.pushParam=function(a){""!==a&&e.push(a)};for(var f=0;f<d.length;f++)":"===d[f].substr(0,1)&&(b.pushParam(c[f]),d[f]=c[f]);return{params:e,RouteArray:d.join("")}},Exception=function(a){throw new TypeError(a)};module.exports=Router;